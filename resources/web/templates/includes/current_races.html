{{- define "current_races" -}}

{{if .Payload.MatchSessions}}
{{range $k, $v := .Payload.MatchSessions}}
<div class="box is-relative nextRace">
    <div class="title has-text-dark nextRace--league">{{t $.Locale "%s league" (index $.Payload.Leagues $v.LeagueID).Name}}</div>
    <div class="subtitle has-text-dark is-size-6-mobile nextRace--schedule">{{$v.StartDate | datetime}}</div>

    <!-- if joinable race -->
    <div class="nextRace--status">
        {{matchSessionStatusTag $.Locale $v.Status}}
        {{if and (future $v.StartDate) (gt (len $v.PlayerIDs) 0)}}
        <span class="tag is-info is-light is-medium is-rounded is-hidden-mobile">{{t $.Locale "Starts in %s" (until $v.StartDate "m")}}</span>
        {{end}}
    </div>

    <div class="nextRace--contextual">
        <!-- not joinable / no players -->
        {{if and (future $v.StartDate) (eq (len $v.PlayerIDs) 0)}}
        <div class="nextRace--contextual--countdown">
            <i class="ri-time-line"></i>
            <div>
                {{t $.Locale "in"}} <span>{{(until $v.StartDate "m")}}</span>
            </div>
        </div>
        {{end}}

        <!-- joinable or w/ players -->
        {{if gt (len $v.PlayerIDs) 0}}
        <div class="nextRace--contextual--players">
            <i class="ri-group-fill"></i>
            <div>
                <span class="nbPlayers">{{len $v.PlayerIDs}}</span>
                {{tn $.Locale "player" "players" (len $v.PlayerIDs)}}
            </div>
        </div>
        {{end}}
    </div>
</div><!-- box -->
{{end}}

{{else}}
<article class="message is-danger">
    <div class="message-body">
        {{t .Locale "There is no scheduled race right now."}}
    </div>
</article>
{{end}}

{{- end -}}
